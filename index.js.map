{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"52982247-0d25e92a2d7c3074b601ee372\";\nconst PER_PAGE = 15;\n\nexport const PER_PAGE_COUNT = PER_PAGE;\n\nexport async function getImagesByQuery(query, page = 1) {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: \"photo\",\n      orientation: \"horizontal\",\n      safesearch: true,\n      page: page,\n      per_page: PER_PAGE,\n    },\n  });\n  return response.data;\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n  gallery: document.querySelector(\".gallery\"),\n  loader: document.querySelector(\".loader\"),\n  loadMoreBtn: document.querySelector(\".load-more-btn\"),\n};\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nexport function createGallery(images, append = false) {\n  const markup = images\n    .map(\n      img => `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\"/>\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Likes:</b><p class=\"info-item-result\">${img.likes}</p></p>\n          <p class=\"info-item\"><b>Views:</b><p class=\"info-item-result\">${img.views}</p></p>\n          <p class=\"info-item\"><b>Comments:</b><p class=\"info-item-result\">${img.comments}</p></p>\n          <p class=\"info-item\"><b>Downloads:</b><p class=\"info-item-result\">${img.downloads}</p></p>\n        </div>\n      </li>`\n    )\n    .join(\"\");\n\n  if (append) {\n    refs.gallery.insertAdjacentHTML(\"beforeend\", markup);\n  } else {\n    refs.gallery.innerHTML = markup;\n  }\n  \n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  refs.gallery.innerHTML = \"\";\n}\n\nexport function showLoader() {\n  refs.loader.classList.remove(\"hidden\");\n}\nexport function hideLoader() {\n  refs.loader.classList.add(\"hidden\");\n}\n\nexport function showLoadMoreButton() {\n  refs.loadMoreBtn.classList.remove(\"is-hidden\");\n}\nexport function hideLoadMoreButton() {\n  refs.loadMoreBtn.classList.add(\"is-hidden\");\n}\n","import { getImagesByQuery, PER_PAGE_COUNT } from \"./js/pixabay-api.js\";\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from \"./js/render-functions.js\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst refs = {\n  form: document.querySelector(\".form\"),\n  input: document.querySelector('input[name=\"search-text\"]'),\n  loadMoreBtn: document.querySelector(\".load-more-btn\"),\n};\n\nlet query = \"\";\nlet page = 1;\nlet totalHits = 0;\n\nrefs.form.addEventListener(\"submit\", onSearch);\nrefs.loadMoreBtn.addEventListener(\"click\", onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n  query = refs.input.value.trim();\n\n  if (!query) {\n    iziToast.warning({\n      title: \"Warning\",\n      message: \"Please enter a search query\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  page = 1;\n  clearGallery();\n  refs.input.value = \"\";\n  hideLoadMoreButton();\n\n  try {\n    showLoader();\n    const data = await getImagesByQuery(query, page);\n    hideLoader();\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.error({\n        message:\n          \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    totalHits = data.totalHits;\n    createGallery(data.hits);\n\n    const totalPages = Math.ceil(totalHits / PER_PAGE_COUNT);\n    if (totalPages > 1) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"That's all results for your search!\",\n        position: \"topRight\",\n      });\n    }\n  } catch (error) {\n    hideLoader(); \n    console.error(error);\n    iziToast.error({\n      title: \"Error\",\n      message: \"Something went wrong while fetching images.\",\n      position: \"topRight\",\n    });\n  }\n}\n\nasync function onLoadMore() {\n  page += 1;\n\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    hideLoader();\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.info({\n        message: \"No more images to load.\",\n        position: \"topRight\",\n      });\n      hideLoadMoreButton();\n      return;\n    }\n\n    createGallery(data.hits, true);\n\n    const totalPages = Math.ceil(totalHits / PER_PAGE_COUNT);\n    if (page >= totalPages) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n\n    const gallery = document.querySelector(\".gallery\");\n    if (gallery && gallery.firstElementChild) {\n      const { height: cardHeight } =\n        gallery.firstElementChild.getBoundingClientRect();\n\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n      });\n    }\n  } catch (error) {\n    hideLoader();\n    console.error(error);\n    iziToast.error({\n      title: \"Error\",\n      message: \"Something went wrong while loading more images.\",\n      position: \"topRight\",\n    });\n  }\n}\n"],"names":["BASE_URL","API_KEY","PER_PAGE","PER_PAGE_COUNT","getImagesByQuery","query","page","axios","refs","lightbox","SimpleLightbox","createGallery","images","append","markup","img","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","totalHits","onSearch","onLoadMore","e","iziToast","data","error","totalPages","gallery","cardHeight"],"mappings":"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"}